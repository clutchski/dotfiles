# Environment (PATH, editor, aliases)
. ~/.profile.sh

# History
setopt append_history       # append rather than overwrite
setopt share_history        # share history across sessions
setopt hist_ignore_dups     # skip consecutive duplicates
setopt hist_ignore_space    # skip commands starting with space
setopt hist_reduce_blanks   # trim extra whitespace
setopt extended_history     # save timestamps
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000

# Directory navigation
setopt auto_cd              # cd by typing directory name
setopt auto_pushd           # push dirs onto stack automatically
setopt pushd_ignore_dups    # no duplicate dirs on stack

# Completion system
# Completions generated by hooks/completions.sh
fpath=(~/.zsh/completions $fpath)
autoload -Uz compinit && compinit

# Prompt -- user@host:~/path(branch)$
autoload -Uz vcs_info
precmd() { vcs_info }
setopt prompt_subst
zstyle ':vcs_info:git:*' formats '%F{yellow}(%b)%f'

if [ $UID -eq 0 ]; then NCOLOR="red"; else NCOLOR="green"; fi
PROMPT="%F{${NCOLOR}}%n%f@%F{cyan}%m%f:%F{magenta}%~%f"'${vcs_info_msg_0_}%F{red}%(!.#.$)%f '
PROMPT2='%F{red}\ %f'
RPS1='%(?..%F{red}%? â†µ%f)'  # show exit code on failure

# Antidote plugin manager (plugins listed in ~/.zsh_plugins.txt)
source ${HOMEBREW_PREFIX:-$(brew --prefix)}/share/antidote/antidote.zsh
antidote load ~/.zsh_plugins.txt

# Mise
if command -v mise &>/dev/null; then
    eval "$(mise activate zsh)"
fi

# Misc
DISABLE_AUTO_TITLE=true     # don't let shell override terminal title
setopt no_prompt_cr         # don't print a CR before the prompt
unsetopt correct_all        # disable zsh command correction
